import{a as ee,b as q}from"./chunk-6HDP2EM3.js";import{b as Pe,c as _e,d as ve,e as Me,f as ge,g as Se}from"./chunk-HJKTOPK2.js";import{A as be,B as Fe,a as ye,b as ue,c as fe,d as F,e as D,u as Ce,v as he,w as Ie,y as xe,z as Te}from"./chunk-IXSSMF7G.js";import{a as le,d as ne,g as se,h as me,i as pe,j,l as $}from"./chunk-IHJXRI23.js";import{Ab as N,Cd as b,Da as s,Dd as R,Fd as W,Gd as O,Ha as y,Hb as I,Hd as ce,Ib as x,Jd as de,Kd as G,Ld as H,Oa as S,Pd as U,Rb as oe,Ta as k,V as re,_a as C,cc as A,db as V,eb as Y,fb as M,ga as u,gb as g,ha as f,hb as r,ib as o,jb as P,kb as h,ld as ae,mb as p,md as B,nb as d,nd as T,qa as X,wa as v,wb as Z,xb as a,yb as w,zb as c}from"./chunk-LGPHYK4G.js";var z=(t=>(t.All="All",t.Pending="Pending",t.Processed="Processed",t))(z||{}),E=class l{searchTerm=v("");selectedFilters=v([]);filterPayslips(i,e,t){let n=this.selectedFilters(),m=this.searchTerm();return i.filter(_=>{let Ne=e.find(Q=>Q.id===_.employeeId)?.name||"",ie=t.find(Q=>Q.id===_.periodId)?.status||"",Ae=m===""||Ne.toLowerCase().includes(m)||_.periodId.toLowerCase().includes(m),Be=n.length===0||n.includes("All")||n.includes("Pending")&&ie==="Pending"||n.includes("Processed")&&ie==="Processed";return Ae&&Be})}setSearchTerm(i){this.searchTerm.set(i.toLowerCase())}toggleFilter(i){this.selectedFilters.update(e=>{if(i==="All")return e.includes("All")?[]:["All"];let t=e.filter(n=>n!=="All");return t.includes(i)?t=t.filter(n=>n!==i):t.push(i),t})}clearFilters(){this.selectedFilters.set([])}removeFilter(i){this.selectedFilters.update(e=>e.filter(t=>t!==i))}static \u0275fac=function(e){return new(e||l)};static \u0275prov=re({token:l,factory:l.\u0275fac,providedIn:"root"})};function $e(l,i){if(l&1){let e=h();r(0,"button",7),p("click",function(){let n=u(e).$implicit,m=d();return m.filterService.toggleFilter(n),f(m.filterChange.emit())}),r(1,"mat-icon"),a(2),o(),r(3,"span"),a(4),o()()}if(l&2){let e=i.$implicit,t=d();s(2),w(t.filterService.selectedFilters().includes(e)?"check_box":"check_box_outline_blank"),s(2),w(e)}}function Re(l,i){if(l&1){let e=h();r(0,"mat-chip"),a(1),r(2,"button",10),p("click",function(){let n=u(e).$implicit,m=d(2);return m.filterService.removeFilter(n),f(m.filterChange.emit())}),r(3,"mat-icon"),a(4,"cancel"),o()()()}if(l&2){let e=i.$implicit;s(),c(" ",e," ")}}function We(l,i){if(l&1&&(r(0,"mat-toolbar-row"),M(1,Re,5,1,"mat-chip",null,Y),o()),l&2){let e=d();s(),g(e.filterService.selectedFilters())}}var J=class l{constructor(i){this.filterService=i}filterChange=new X;addPayPeriod=new X;filterTypes=Object.values(z);PayrollFilterType=z;onSearch(i){let e=i.target.value;this.filterService.setSearchTerm(e),this.filterChange.emit()}static \u0275fac=function(e){return new(e||l)(y(E))};static \u0275cmp=S({type:l,selectors:[["app-payroll-toolbar"]],outputs:{filterChange:"filterChange",addPayPeriod:"addPayPeriod"},decls:33,vars:4,consts:[["menu","matMenu"],["filterMenu","matMenu"],["matInput","","placeholder","Search payslips",3,"input"],["matSuffix",""],[2,"flex","1 1 auto"],["mat-icon-button","","aria-label","Menu button",3,"matMenuTriggerFor"],["mat-menu-item","",3,"matMenuTriggerFor"],["mat-menu-item","",3,"click"],["mat-menu-item",""],["mat-menu-item","",3,"click","disabled"],["matChipRemove","",3,"click"]],template:function(e,t){if(e&1){let n=h();r(0,"mat-toolbar")(1,"mat-toolbar-row")(2,"mat-form-field")(3,"mat-label"),a(4,"Search"),o(),r(5,"input",2),p("input",function(_){return u(n),f(t.onSearch(_))}),o(),r(6,"mat-icon",3),a(7,"search"),o()(),P(8,"span",4),r(9,"button",5)(10,"mat-icon"),a(11,"more_vert"),o()(),r(12,"mat-menu",null,0)(14,"button",6)(15,"mat-icon"),a(16,"filter_list"),o(),r(17,"span"),a(18,"Filters"),o()(),r(19,"button",7),p("click",function(){return u(n),f(t.addPayPeriod.emit())}),r(20,"mat-icon"),a(21,"add"),o(),r(22,"span"),a(23,"Add Pay Period"),o()()(),r(24,"mat-menu",null,1),M(26,$e,5,2,"button",8,Y),P(28,"mat-divider"),r(29,"button",9),p("click",function(){return u(n),t.filterService.clearFilters(),f(t.filterChange.emit())}),r(30,"span"),a(31,"Clear Filters"),o()()()(),k(32,We,3,0,"mat-toolbar-row"),o()}if(e&2){let n=Z(13),m=Z(25);s(9),C("matMenuTriggerFor",n),s(5),C("matMenuTriggerFor",m),s(12),g(t.filterTypes),s(3),C("disabled",t.filterService.selectedFilters().length===0),s(3),V(t.filterService.selectedFilters().length>0?32:-1)}},dependencies:[me,se,le,ne,_e,Pe,T,B,fe,ue,ye,D,F,Se,Me,ve,ge,$,j,pe,R,b],encapsulation:2})};var Ue=(l,i)=>i.type;function qe(l,i){if(l&1&&a(0),l&2){let e=d().$implicit;c(" (",e.percentage*100,"%) ")}}function ze(l,i){if(l&1&&(r(0,"span",3),a(1),I(2,"currency"),k(3,qe,1,1),o()),l&2){let e=i.$implicit;s(),N(" ",e.type,": ",x(2,3,e.amount)," "),s(2),V(e.percentage?3:-1)}}var K=class l{constructor(i,e,t){this.dialogRef=i;this.payslip=e;this.payrollService=t;let n=this.payrollService.getEmployees()().find(m=>m.id===e.employeeId);this.employeeName=n?.name||"Unknown Employee"}employeeName;closeDialog(){this.dialogRef.close()}static \u0275fac=function(e){return new(e||l)(y(Ce),y(he),y(q))};static \u0275cmp=S({type:l,selectors:[["app-payslip-detail"]],decls:38,vars:10,consts:[["mat-dialog-title",""],["matListItemIcon",""],["matListItemTitle",""],["matListItemLine",""],["mat-button","",3,"click"]],template:function(e,t){e&1&&(r(0,"h2",0),a(1),o(),r(2,"mat-dialog-content")(3,"mat-list")(4,"mat-list-item")(5,"mat-icon",1),a(6,"person"),o(),r(7,"span",2),a(8),o(),r(9,"span",3),a(10),o()(),P(11,"mat-divider"),r(12,"mat-list-item")(13,"mat-icon",1),a(14,"attach_money"),o(),r(15,"span",2),a(16),I(17,"currency"),o(),r(18,"span",3),a(19),I(20,"currency"),o()(),P(21,"mat-divider"),r(22,"mat-list-item")(23,"mat-icon",1),a(24,"list"),o(),r(25,"span",2),a(26,"Deductions:"),o(),M(27,ze,4,5,"span",3,Ue),o(),P(29,"mat-divider"),r(30,"mat-list-item")(31,"mat-icon",1),a(32,"calendar_today"),o(),r(33,"span",2),a(34),o()()()(),r(35,"mat-dialog-actions")(36,"button",4),p("click",function(){return t.closeDialog()}),a(37,"Close"),o()()),e&2&&(s(),c("Payslip - ",t.employeeName,""),s(7),c("Employee ID: ",t.payslip.employeeId,""),s(2),c("Period: ",t.payslip.periodId,""),s(6),c("Gross Pay: ",x(17,6,t.payslip.grossPay),""),s(3),c("Net Pay: ",x(20,8,t.payslip.netPay),""),s(8),g(t.payslip.deductions),s(7),c("Payment Date: ",t.payslip.paymentDate,""))},dependencies:[Fe,xe,be,Te,T,ae,U,G,H,de,b,O,W,D,F,A],encapsulation:2})};var Je=(l,i)=>i.payslip.id;function Ke(l,i){if(l&1){let e=h();r(0,"mat-list-item",1),p("click",function(){let n=u(e).$implicit,m=d();return f(m.onPayslipClick(n.payslip))}),r(1,"span",2),a(2),o(),r(3,"span",3),a(4),I(5,"currency"),o(),r(6,"div",4)(7,"mat-chip",5),a(8),o(),r(9,"button",6),p("click",function(n){let m=u(e).$implicit;return d().regeneratePayslip(m.payslip),f(n.stopPropagation())}),r(10,"mat-icon"),a(11,"refresh"),o()()()(),P(12,"mat-divider")}if(l&2){let e=i.$implicit,t=d();s(2),w(e.employeeName),s(2),N(" Period: ",e.payslip.periodId," | Net Pay: ",x(5,5,e.payslip.netPay)," "),s(3),C("color",e.periodStatus===t.PayPeriodStatus.Pending?"warn":"primary"),s(),c(" ",e.periodStatus," ")}}var Ve=class l{constructor(i,e,t){this.payrollService=i;this.dialog=e;this.filterService=t;this.payslips.set(this.payrollService.getPayslips()()),this.payPeriods.set(this.payrollService.getPayPeriods()()),this.updateFilteredPayslips(),oe(()=>{this.payslips.set(this.payrollService.getPayslips()()),this.payPeriods.set(this.payrollService.getPayPeriods()()),this.updateFilteredPayslips()})}payslips=v([]);payPeriods=v([]);filteredPayslips=v([]);PayPeriodStatus=ee;onPayslipClick(i){this.dialog.open(K,{data:i})}regeneratePayslip(i){console.log("Regenerate payslip:",i)}addNewPayPeriod(){console.log("Adding new pay period")}updateFilteredPayslips(){let i=this.payrollService.getEmployees()(),t=this.filterService.filterPayslips(this.payslips(),i,this.payPeriods()).map(n=>{let m=i.find(L=>L.id===n.employeeId),_=this.payPeriods().find(L=>L.id===n.periodId);return{payslip:n,employeeName:m?.name||n.employeeId,periodStatus:_?.status||"Pending"}});this.filteredPayslips.set(t)}static \u0275fac=function(e){return new(e||l)(y(q),y(Ie),y(E))};static \u0275cmp=S({type:l,selectors:[["app-payroll-list"]],decls:4,vars:0,consts:[[3,"filterChange","addPayPeriod"],[3,"click"],["matListItemTitle",""],["matListItemLine",""],["matListItemMeta",""],["highlighted","",3,"color"],["mat-icon-button","",3,"click"]],template:function(e,t){e&1&&(r(0,"app-payroll-toolbar",0),p("filterChange",function(){return t.updateFilteredPayslips()})("addPayPeriod",function(){return t.addNewPayPeriod()}),o(),r(1,"mat-list"),M(2,Ke,13,7,null,null,Je),o()),e&2&&(s(2),g(t.filteredPayslips()))},dependencies:[U,G,H,b,O,W,ce,D,F,R,T,B,$,j,A,J],encapsulation:2})};export{Ve as PayrollListComponent};
